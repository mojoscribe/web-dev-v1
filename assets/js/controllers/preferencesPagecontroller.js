var PreferencesPageCtrl=["$scope","$http","$timeout",function(e,t,n){t.defaults.headers.common["XSRF_TOKEN"]=$("#csrf").val();e.categories={};e.userId=$("#userId").val();e.mobile=false;e.email=false;e.emailNotify={email:""};e.timeZone="";e.check=[];e.sentCategories={};e.locations=[];e.index=0;e.getUserEmail=function(){var n=baseUrl+"settings/getEmail";t.get(n).success(function(t){e.emailNotify.email=t.data.email})};e.getUserNotifications=function(){var e=baseUrl+"settings/getUserNotifications";t.get(e).success(function(e){if(e.success==true){}})};e.getUserPreferences=function(){var n=baseUrl+"settings/getUserPreferences";t.get(n).success(function(t){if(t.success==true){if(t.data!=""){if(t.data.userLocations!=""||null){e.locations=t.data.userLocations}if(t.data.timeZone!=(""||null)){e.timeZone=t.data.timeZone}}e.mobile=t.data.notifications.mobile;e.email=t.data.notifications.email;e.sentCategories=t.data.categoryPreferences}})};e.getCategories=function(){var n=baseUrl+"settings/getCategories";t.get(n).success(function(t){e.categories=t.data})};e.saveCategory=function(n){var r=baseUrl+"settings/saveCategory";var i=JSON.stringify(e.categories[n]);t.post(r,i).success(function(e){})};e.saveMobileNotification=function(){var e=baseUrl+"settings/saveMobileNotification";t.get(e).success(function(e){})};e.saveEmailNotification=function(){var e=baseUrl+"settings/saveEmailNotification";t.get(e).success(function(e){})};e.initCitySearch=function(){var t={types:["(cities)"]};var r=document.getElementById("location-city");var i=new google.maps.places.Autocomplete(r,t);var s={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"};google.maps.event.addListener(i,"place_changed",function(){var t=i.getPlace();var r=t.geometry.location.lat();var s=t.geometry.location.lng();var o=t.address_components[0].types[0];if("locality"==o){e.locations.push(t.address_components[0].long_name);e.$apply();n(function(){$("#location-city").val("")},50)}else{}})};e.removeLocation=function(t){e.locations.splice(t,1)};e.saveSettings=function(){var n=new FormData;n.append("categories",JSON.stringify(e.sentCategories));n.append("locations",e.locations);n.append("userId",e.userId);n.append("timeZone",e.timeZone);var r=baseUrl+"settings/preferencesSettingsSave";var i=n;t.post(r,i,{transformRequest:angular.identity,headers:{"Content-type":undefined}}).success(function(t){if(t.success==true){if(t.data.msg=="Saved"){window.location=baseUrl;$("#save-modal").modal("show");e.saveModal()}}else{}})};e.saveModal=function(){n(function(){window.location.href=baseUrl+"dashboard"},1e3)};e.getUserPreferences();e.getCategories();e.getUserEmail();e.initCitySearch();$(window).keydown(function(e){if(e.keyCode==13){e.preventDefault();return false}})}]